{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{399:function(s,a,t){\"use strict\";t.r(a);var e=t(31),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[t(\"h1\",{attrs:{id:\"docker-部署mysql服务器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-部署mysql服务器\"}},[s._v(\"#\")]),s._v(\" docker 部署mysql服务器\")]),s._v(\" \"),t(\"h2\",{attrs:{id:\"docker-pull下载镜像\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-pull下载镜像\"}},[s._v(\"#\")]),s._v(\" docker pull下载镜像\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[t(\"code\",[s._v(\"docker pull mysql:8.0.26\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"p\",[t(\"img\",{attrs:{src:\"/img/image-20211124103513988.png\",alt:\"image-20211124103513988\"}})]),s._v(\" \"),t(\"h2\",{attrs:{id:\"启动一个mysql容器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#启动一个mysql容器\"}},[s._v(\"#\")]),s._v(\" 启动一个mysql容器\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[t(\"code\",[s._v(\"docker run -p \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3306\")]),s._v(\":3306 --name mantu-mysql -v /usr/local/workspace/mysql/conf:/etc/mysql -v /workspace/mysql/data:/var/lib/mysql -v /workspace/mysql/mysql-files:/var/lib/mysql-files/ -e \"),t(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_ROOT_PASSWORD\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"xxxx -d mysql:8.0.26 --skip-name-resolve\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"p\",[s._v(\"启动参数说明：\")]),s._v(\" \"),t(\"ol\",[t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"-p\")]),s._v(\":端口映射\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"--name mantu-mysql\")]),s._v(\":容器名\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"-v /usr/local/workspace/mysql/conf:/etc/mysql\")]),s._v(\"：mysql配置文件映射路径\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"-v /workspace/mysql/data:/var/lib/mysql\")]),s._v(\":数据文件映射路径\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"-v /workspace/mysql/mysql-files:/var/lib/mysql-files/\")]),s._v(\":其他文件映射路径\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"-e MYSQL_ROOT_PASSWORD=xxxx\")]),s._v(\":root账户密码\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"-d mysql:8.0.26\")]),s._v(\":使用哪个镜像启动\")])]),s._v(\" \"),t(\"li\",[t(\"p\",[t(\"code\",[s._v(\"--skip-name-resolve:\")]),s._v(\"跳过内部dns解析（mysql8.0+版本内部会有dns解析，导致外部连接时延迟甚至在20s以上）\")]),s._v(\" \"),t(\"p\",[s._v(\"检查启动好的mysql容器\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[t(\"code\",[s._v(\"docker \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ps\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])])])]),s._v(\" \"),t(\"h2\",{attrs:{id:\"首次登陆使用自定义配置文件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#首次登陆使用自定义配置文件\"}},[s._v(\"#\")]),s._v(\" 首次登陆使用自定义配置文件\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"首次登陆mysql容器\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#首次登陆mysql容器\"}},[s._v(\"#\")]),s._v(\" 首次登陆mysql容器\")]),s._v(\" \"),t(\"p\",[s._v(\"进入到容器中\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[t(\"code\",[s._v(\"docker \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"容器名\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" /bin/bash\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"p\",[s._v(\"容器中执行：\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[t(\"code\",[s._v(\"mysql -uroot -p\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"p\",[s._v(\"输入root密码即可登陆到mysql。\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"创建库及用户-并赋予权限-一般只赋予root用户创建库权限\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建库及用户-并赋予权限-一般只赋予root用户创建库权限\"}},[s._v(\"#\")]),s._v(\" 创建库及用户，并赋予权限（一般只赋予root用户创建库权限）\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-sql line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-sql\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"--创建库\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"create\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"database\")]),s._v(\" xxxxx \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"default\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"charset\")]),s._v(\" utf8 \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"collate\")]),s._v(\" utf8_general_ci\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"--创建用户\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"create\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'用户名'\")]),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"@'可登陆范围'\")]),s._v(\"  indentified \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"by\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'password'\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"--赋予用户权限\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"grant\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"all\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"privileges\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"on\")]),s._v(\" 库名\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"*\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"to\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'用户名'\")]),t(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"@'可登陆范围'\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"p\",[s._v(\"其中，可登陆范围，一般设置为\"),t(\"code\",[s._v(\"%\")]),s._v(\"，则\"),t(\"strong\",[s._v(\"默认任何ip都可以登陆\")]),s._v(\"，生产环境这样配置是\"),t(\"strong\",[s._v(\"非常不安全\")]),s._v(\"的，但作为备库（开发库），可以免去外网ip变化之后无法登陆库。\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"跳过root验证-可选\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#跳过root验证-可选\"}},[s._v(\"#\")]),s._v(\" 跳过root验证（可选）\")]),s._v(\" \"),t(\"p\",[s._v(\"如下命令是跳过root验证，因为有些情况下，mysql容器会把root用户的改成一堆随机值。导致上面步骤无法通过root登陆进去。如果出现在容器内部，使用\")]),s._v(\" \"),t(\"p\",[t(\"code\",[s._v(\"mysql -uroot -p\")]),s._v(\"命令，输入密码无法登陆，且报用户名密码错误则需要执行本步骤。\")]),s._v(\" \"),t(\"ol\",[t(\"li\",[s._v(\"在宿主机的\"),t(\"code\",[s._v(\"/usr/local/workspace/mysql/conf\")]),s._v(\"路径下创建\"),t(\"code\",[s._v(\"my.cnf\")])])]),s._v(\" \"),t(\"p\",[s._v(\"​\\t\\t内容为：\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-conf line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[t(\"code\",[s._v(\"[mysqld]\\nskip-grant-tables\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"p\",[s._v(\"​\\t保存退出。\")]),s._v(\" \"),t(\"ol\",{attrs:{start:\"2\"}},[t(\"li\",[t(\"p\",[s._v(\"再登陆到容器中，使用\"),t(\"code\",[s._v(\"mysql -uroot -p\")]),s._v(\"，直接回车即可登陆进来，无需再输入密码。\")]),s._v(\" \"),t(\"p\",[s._v(\"此时执行如下语句：\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-sql line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-sql\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),s._v(\" mysql\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"select\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"authentication_string\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"host \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"from\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"update\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"set\")]),s._v(\" authentication_string\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"''\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"where\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'root'\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\nflush \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"privileges\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"p\",[s._v(\"此时再把第一步的文件内容\"),t(\"code\",[s._v(\"skip-grant-tables\")]),s._v(\"注释掉即可。\")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);","extractedComments":[]}
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{400:function(s,a,e){\"use strict\";e.r(a);var t=e(31),r=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"docker-部署mysql服务器\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-部署mysql服务器\"}},[s._v(\"#\")]),s._v(\" docker 部署mysql服务器\")]),s._v(\" \"),e(\"h2\",{attrs:{id:\"docker-pull下载镜像\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#docker-pull下载镜像\"}},[s._v(\"#\")]),s._v(\" docker pull下载镜像\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[e(\"code\",[s._v(\"docker pull mysql:8.0.26\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\")])]),e(\"p\",[e(\"img\",{attrs:{src:\"/img/image-20211124103513988.png\",alt:\"image-20211124103513988\"}})]),s._v(\" \"),e(\"h2\",{attrs:{id:\"启动一个mysql容器\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#启动一个mysql容器\"}},[s._v(\"#\")]),s._v(\" 启动一个mysql容器\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[e(\"code\",[s._v(\"docker run -p \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3306\")]),s._v(\":3306 --name mantu-mysql -v /usr/local/workspace/mysql/conf:/etc/mysql -v /workspace/mysql/data:/var/lib/mysql -v /workspace/mysql/mysql-files:/var/lib/mysql-files/ -e \"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[s._v(\"MYSQL_ROOT_PASSWORD\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"xxxx -d mysql:8.0.26 --skip-name-resolve\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\")])]),e(\"p\",[s._v(\"启动参数说明：\")]),s._v(\" \"),e(\"ol\",[e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"-p\")]),s._v(\":端口映射\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"--name mantu-mysql\")]),s._v(\":容器名\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"-v /usr/local/workspace/mysql/conf:/etc/mysql\")]),s._v(\"：mysql配置文件映射路径\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"-v /workspace/mysql/data:/var/lib/mysql\")]),s._v(\":数据文件映射路径\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"-v /workspace/mysql/mysql-files:/var/lib/mysql-files/\")]),s._v(\":其他文件映射路径\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"-e MYSQL_ROOT_PASSWORD=xxxx\")]),s._v(\":root账户密码\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"-d mysql:8.0.26\")]),s._v(\":使用哪个镜像启动\")])]),s._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[s._v(\"--skip-name-resolve:\")]),s._v(\"跳过内部dns解析（mysql8.0+版本内部会有dns解析，导致外部连接时延迟甚至在20s以上）\")]),s._v(\" \"),e(\"p\",[s._v(\"检查启动好的mysql容器\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[e(\"code\",[s._v(\"docker \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ps\")]),s._v(\"\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\")])])])]),s._v(\" \"),e(\"h2\",{attrs:{id:\"首次登陆使用自定义配置文件\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#首次登陆使用自定义配置文件\"}},[s._v(\"#\")]),s._v(\" 首次登陆使用自定义配置文件\")]),s._v(\" \"),e(\"h3\",{attrs:{id:\"首次登陆mysql容器\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#首次登陆mysql容器\"}},[s._v(\"#\")]),s._v(\" 首次登陆mysql容器\")]),s._v(\" \"),e(\"p\",[s._v(\"进入到容器中\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[e(\"code\",[s._v(\"docker \"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"exec\")]),s._v(\" -it \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"<\")]),s._v(\"容器名\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" /bin/bash\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\")])]),e(\"p\",[s._v(\"容器中执行：\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-sh line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[e(\"code\",[s._v(\"mysql -uroot -p\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\")])]),e(\"p\",[s._v(\"输入root密码即可登陆到mysql。\")]),s._v(\" \"),e(\"h3\",{attrs:{id:\"创建库及用户-并赋予权限-一般只赋予root用户创建库权限\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#创建库及用户-并赋予权限-一般只赋予root用户创建库权限\"}},[s._v(\"#\")]),s._v(\" 创建库及用户，并赋予权限（一般只赋予root用户创建库权限）\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-mysql line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[s._v(\"---创建库\\ncreate database xxxxx default charset utf8 collate utf8_general_ci;\\n---创建用户\\ncreate user '用户名'@'可登陆范围'  indentified by 'password'\\n---赋予用户权限\\ngrant all privileges on 库名.* to '用户名'@'可登陆范围'\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),e(\"br\")])]),e(\"p\",[s._v(\"其中，可登陆范围，一般设置为\"),e(\"code\",[s._v(\"%\")]),s._v(\"，则\"),e(\"strong\",[s._v(\"默认任何ip都可以登陆\")]),s._v(\"，生产环境这样配置是\"),e(\"strong\",[s._v(\"非常不安全\")]),s._v(\"的，但作为备库（开发库），可以免去外网ip变化之后无法登陆库。\")]),s._v(\" \"),e(\"h3\",{attrs:{id:\"跳过root验证-可选\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#跳过root验证-可选\"}},[s._v(\"#\")]),s._v(\" 跳过root验证（可选）\")]),s._v(\" \"),e(\"p\",[s._v(\"如下命令是跳过root验证，因为有些情况下，mysql容器会把root用户的改成一堆随机值。导致上面步骤无法通过root登陆进去。如果出现在容器内部，使用\")]),s._v(\" \"),e(\"p\",[e(\"code\",[s._v(\"mysql -uroot -p\")]),s._v(\"命令，输入密码无法登陆，且报用户名密码错误则需要执行本步骤。\")]),s._v(\" \"),e(\"ol\",[e(\"li\",[s._v(\"在宿主机的\"),e(\"code\",[s._v(\"/usr/local/workspace/mysql/conf\")]),s._v(\"路径下创建\"),e(\"code\",[s._v(\"my.cnf\")])])]),s._v(\" \"),e(\"p\",[s._v(\"​\\t\\t内容为：\")]),s._v(\" \"),e(\"div\",{staticClass:\"language- line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[s._v(\"[mysqld]\\nskip-grant-tables\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\")])]),e(\"p\",[s._v(\"​\\t保存退出。\")]),s._v(\" \"),e(\"ol\",{attrs:{start:\"2\"}},[e(\"li\",[e(\"p\",[s._v(\"再登陆到容器中，使用\"),e(\"code\",[s._v(\"mysql -uroot -p\")]),s._v(\"，直接回车即可登陆进来，无需再输入密码。\")]),s._v(\" \"),e(\"p\",[s._v(\"此时执行如下语句：\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-sql line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-sql\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),s._v(\" mysql\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"select\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"authentication_string\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"host \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"from\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"update\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"set\")]),s._v(\" authentication_string\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"''\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"where\")]),s._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"user\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'root'\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\nflush \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"privileges\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\")])]),e(\"p\",[s._v(\"此时再把第一步的文件内容\"),e(\"code\",[s._v(\"skip-grant-tables\")]),s._v(\"注释掉即可。\")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);","extractedComments":[]}